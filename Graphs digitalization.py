import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit
# Creating the 2D numpy array from the provided data

def f(x,a,b,c,d,e):
    f=a*x**5+b*x**4+c*x**3+d*x**2+e*x
    return f

def Ktuf(x):
    coef=[-1.10757616,  3.61431483, - 3.51609595,  0.21966005,  1.28383368]
    Ktu=coef[0]*x**5+coef[1]*x**4+coef[2]*x**3+coef[3]*x**2+coef[4]*x
    return Ktu

def Kbrf(x):
    coef = [-0.07657563,  0.73556647, - 2.56227493,  3.71020721, - 0.85730079]
    Kbr = coef[0] * x ** 5 + coef[1] * x ** 4 + coef[2] * x ** 3 + coef[3] * x ** 2 + coef[4] * x
    return Kbr



def Kuf(x):
    coef = [ 0.00520646, -0.08747833,  0.54885174, -1.59859635,  2.10344953]
    Ku = coef[0] * x ** 5 + coef[1] * x ** 4 + coef[2] * x ** 3 + coef[3] * x ** 2 + coef[4] * x
    return Ku

Ktu = np.array([
    [1.3999996195212243, 0.5142857414627697],
    [1.3090906842625418, 0.516883079823496],
    [1.202597338360726, 0.5116881177429617],
    [1.1116882128626555, 0.5090908745019295],
    [1.0259739543254258, 0.5064935361412031],
    [0.9272726235057889, 0.4987013308196369],
    [0.8207792776039732, 0.48831150177826277],
    [0.7246752851450624, 0.47792205321566383],
    [0.6389610266078325, 0.46753250953337133],
    [0.5506494297098758, 0.4493504751704306],
    [0.46233802305130706, 0.4259739543254254],
    [0.394805323278548, 0.4051948669608403],
    [0.32727281374517697, 0.3714285170744607],
    [0.2779222434550521, 0.3402596957881951],
    [0.23896121684722038, 0.29350646385879686],
    [0.20259752860011448, 0.24935076052951255],
    [0.17142870731384918, 0.20779220532156642],
    [0.13766254766685737, 0.161038973392168],
    [0.10649372638059185, 0.12207794678433632],
    [0.06753269977275977, 0.07272737649421177],
    [0.03116901152565421, 0.025973954325425375],
    [0.007792395560955012, -0.0025973383607261202]
])

Kbr = np.array([
    [0.39583343505859436, -0.00421135084876334],
    [0.4500000000000006, 0.10105206674139788],
    [0.5083334350585944, 0.2105256016270557],
    [0.5625000000000004, 0.3073678594612752],
    [0.6125000000000005, 0.4042101172954953],
    [0.6791667175292974, 0.5010520667413986],
    [0.7375000000000006, 0.5978943245756186],
    [0.8125000000000003, 0.7115785935334046],
    [0.8875000000000003, 0.8252628624911911],
    [0.9583334350585944, 0.9389471314489775],
    [1.0541665649414067, 1.0568416718964182],
    [1.1458334350585941, 1.1578943554144505],
    [1.2250000000000003, 1.2547367674428287],
    [1.3166665649414064, 1.3389472856431361],
    [1.4041665649414063, 1.4273683837214144],
    [1.4916665649414065, 1.5073683220437513],
    [1.5875000000000004, 1.5915789944382168],
    [1.6791665649414063, 1.6842105182003078],
    [1.7791665649414061, 1.7768421961565566],
    [1.875, 1.8484211289171102],
    [1.9874999999999998, 1.9410528068733592],
    [2.0958337402343745, 2.021052899389854],
    [2.2, 2.0968424120283786],
    [2.316666564941406, 2.1768425045448736],
    [2.4333337402343744, 2.248421360208348],
    [2.5333334350585934, 2.3073687846262265],
    [2.633333435058594, 2.3747372146058883],
    [2.7375, 2.4336846390237667],
    [2.8458334350585934, 2.501053146100508],
    [2.9749999999999996, 2.5726320788610613],
    [3.0916665649414057, 2.6400005859378024],
    [3.2041665649414055, 2.6947374304777103],
    [3.3125, 2.753684854895589],
    [3.429166564941406, 2.8084216994354962]
])

Ku = np.array([
    [1.0198019801980198, 0.9986613200850276],
    [1.1914193030631188, 0.9986613200850276],
    [1.3762376237623763, 0.995983935742972],
    [1.5676569268254952, 0.9892905116559991],
    [1.7986806737314356, 0.9799196787148594],
    [1.9967004757116338, 0.9718875502008032],
    [2.201320293162129, 0.959839357429719],
    [2.3927400796720297, 0.9504685490006903],
    [2.5973598971225242, 0.9370816763146336],
    [2.782178217821782, 0.9277108433734941],
    [3.0066014658106437, 0.9210174192865211],
    [3.2178217821782185, 0.9210174192865211],
    [3.4290430654393567, 0.91834002268841],
    [3.6270628674195544, 0.9129852907724648],
    [3.871287128712872, 0.9022757779163529],
    [4.056105932858911, 0.8915662650602411],
    [4.267326732673268, 0.8755020080321285],
    [4.491749497215347, 0.8527443269170433],
    [4.669967318997525, 0.8232931726907632],
    [4.808581180383664, 0.797858107233622],
    [4.887789101175743, 0.768406953007342],
    [5.006600982363862, 0.7483266317222014],
    [4.1683168316831685, 0.8808567767162401],
    [4.3795381149443084, 0.8607764554310995],
    [4.577557916924506, 0.8366800698889308],
    [3.7524752475247536, 0.9076305220883535]
])


fit=curve_fit(f, Ktu[:,0],Ktu[:,1])
fit1=curve_fit(f, Kbr[:,0],Kbr[:,1])
fit2=curve_fit(f, Ku[:,0],Ku[:,1])
print(fit[0])

plt.scatter(Kbr[:,0],Kbr[:,1])
#plt.plot(Ktu[:,0],f(Ktu[:,0],fit[0][0],fit[0][1],fit[0][2],fit[0][3],fit[0][4]))
plt.plot(Kbr[:,0],Kbrf(Kbr[:,0]),color="r")
plt.show()

