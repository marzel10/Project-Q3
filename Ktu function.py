import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit
# Creating the 2D numpy array from the provided data

def f(x,a,b,c,d,e):
    f=a*x**5+b*x**4+c*x**3+d*x**2+e*x
    return f

def Ktuf(x):
    coef=[-1.10757616,  3.61431483, - 3.51609595,  0.21966005,  1.28383368]
    Ktu=coef[0]*x**5+coef[1]*x**4+coef[2]*x**3+coef[3]*x**2+coef[4]*x
    return Ktu
Ktu = np.array([
    [1.3999996195212243, 0.5142857414627697],
    [1.3090906842625418, 0.516883079823496],
    [1.202597338360726, 0.5116881177429617],
    [1.1116882128626555, 0.5090908745019295],
    [1.0259739543254258, 0.5064935361412031],
    [0.9272726235057889, 0.4987013308196369],
    [0.8207792776039732, 0.48831150177826277],
    [0.7246752851450624, 0.47792205321566383],
    [0.6389610266078325, 0.46753250953337133],
    [0.5506494297098758, 0.4493504751704306],
    [0.46233802305130706, 0.4259739543254254],
    [0.394805323278548, 0.4051948669608403],
    [0.32727281374517697, 0.3714285170744607],
    [0.2779222434550521, 0.3402596957881951],
    [0.23896121684722038, 0.29350646385879686],
    [0.20259752860011448, 0.24935076052951255],
    [0.17142870731384918, 0.20779220532156642],
    [0.13766254766685737, 0.161038973392168],
    [0.10649372638059185, 0.12207794678433632],
    [0.06753269977275977, 0.07272737649421177],
    [0.03116901152565421, 0.025973954325425375],
    [0.007792395560955012, -0.0025973383607261202]
])
fit=curve_fit(f, Ktu[:,0],Ktu[:,1])
print(fit[0])
X=Ktu[:,0]
print(X)
plt.scatter(Ktu[:,0],Ktu[:,1])
#plt.plot(Ktu[:,0],f(Ktu[:,0],fit[0][0],fit[0][1],fit[0][2],fit[0][3],fit[0][4]))
plt.plot(Ktu[:,0],Ktuf(Ktu[:,0]))
plt.show()

